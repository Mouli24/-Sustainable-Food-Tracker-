<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoFood Tracker — Sustainable Food Choices</title>
    <meta name="description" content="Scan, search, and discover the nutritional value and environmental impact of your food.">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="index.css">

    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/quagga@0.12.1/dist/quagga.min.js"></script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-storage-compat.js"></script>

    <!-- App Script -->
    <script src="index.js" defer></script>
</head>
<body>

    <!-- ========== AUTH SCREENS ========== -->
    <div id="auth-wrapper" class="auth-wrapper">

        <!-- Login Page -->
        <div id="auth-login" class="auth-page active">
            <div class="auth-card">
                <div class="auth-logo">
                    <svg class="logo-icon" width="56" height="56" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="50" cy="50" r="48" fill="#2d8a6e"/>
                        <path d="M70 25C45 25 28 42 28 62c0 6 2 10 5 13 3-15 12-28 27-35-10 12-16 26-17 40 2 1 4 2 7 2 18 0 30-15 30-35 0-8-2-15-5-20" fill="white" opacity="0.95"/>
                    </svg>
                    <h1>EcoFood Tracker</h1>
                    <p>Make every meal healthier & sustainable</p>
                </div>

                <form id="login-form" class="auth-form">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" placeholder="you@example.com" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" placeholder="Your password" required>
                    </div>
                    <div id="login-error" class="auth-error hidden"></div>
                    <button type="submit" class="btn btn-primary full-width" id="login-btn">Sign In</button>
                </form>

                <div class="auth-divider"><span>or</span></div>

                <button class="btn btn-google full-width" id="google-login-btn">
                    <svg width="18" height="18" viewBox="0 0 48 48"><path fill="#4285F4" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#34A853" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59A14.5 14.5 0 019.5 24c0-1.59.28-3.14.76-4.59l-7.98-6.19A23.99 23.99 0 000 24c0 3.77.9 7.35 2.56 10.52l7.97-5.93z"/><path fill="#EA4335" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 5.93C6.51 42.62 14.62 48 24 48z"/></svg>
                    Continue with Google
                </button>

                <p class="auth-switch">Don't have an account? <a href="#" id="show-signup">Create one</a></p>
            </div>
        </div>

        <!-- Signup Page -->
        <div id="auth-signup" class="auth-page">
            <div class="auth-card">
                <div class="auth-logo">
                    <svg class="logo-icon" width="56" height="56" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="50" cy="50" r="48" fill="#2d8a6e"/>
                        <path d="M70 25C45 25 28 42 28 62c0 6 2 10 5 13 3-15 12-28 27-35-10 12-16 26-17 40 2 1 4 2 7 2 18 0 30-15 30-35 0-8-2-15-5-20" fill="white" opacity="0.95"/>
                    </svg>
                    <h1>Create Account</h1>
                    <p>Join EcoFood Tracker today</p>
                </div>

                <form id="signup-form" class="auth-form">
                    <div class="form-group">
                        <label for="signup-name">Full Name</label>
                        <input type="text" id="signup-name" placeholder="Your name" required>
                    </div>
                    <div class="form-group">
                        <label for="signup-email">Email</label>
                        <input type="email" id="signup-email" placeholder="you@example.com" required>
                    </div>
                    <div class="form-group">
                        <label for="signup-password">Password</label>
                        <input type="password" id="signup-password" placeholder="Min 6 characters" required minlength="6">
                    </div>
                    <div id="signup-error" class="auth-error hidden"></div>
                    <button type="submit" class="btn btn-primary full-width" id="signup-btn">Create Account</button>
                </form>

                <p class="auth-switch">Already have an account? <a href="#" id="show-login">Sign in</a></p>
            </div>
        </div>
    </div>

    <!-- ========== APP (hidden until logged in) ========== -->
    <div id="app-wrapper" class="hidden">

        <!-- HEADER -->
        <header class="site-header">
            <nav class="navbar container">
                <a href="#" class="logo" data-page="home">
                    <svg class="logo-icon" width="34" height="34" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="50" cy="50" r="48" fill="#2d8a6e"/>
                        <path d="M70 25C45 25 28 42 28 62c0 6 2 10 5 13 3-15 12-28 27-35-10 12-16 26-17 40 2 1 4 2 7 2 18 0 30-15 30-35 0-8-2-15-5-20" fill="white" opacity="0.95"/>
                        <path d="M50 45c8-5 18-8 25-8" stroke="white" stroke-width="2" fill="none" opacity="0.5"/>
                    </svg>
                    <span>EcoFood Tracker</span>
                </a>
                <ul class="nav-links" id="nav-links">
                    <li><a href="#" class="nav-link active" data-page="home">Home</a></li>
                    <li><a href="#" class="nav-link" data-page="search">Search</a></li>
                    <li><a href="#" class="nav-link" data-page="dashboard">Dashboard</a></li>
                    <li><a href="#" class="nav-link" data-page="profile">Profile</a></li>
                    <li><a href="#" class="nav-link" data-page="about">About</a></li>
                </ul>
                <div class="nav-right">
                    <div class="nav-avatar" id="nav-avatar" title="Profile">
                        <img id="nav-avatar-img" src="" alt="avatar">
                        <span id="nav-avatar-initial"></span>
                    </div>
                    <button class="burger" id="burger" aria-label="Menu" aria-expanded="false">
                        <span class="burger-line"></span>
                        <span class="burger-line"></span>
                        <span class="burger-line"></span>
                    </button>
                </div>
            </nav>
        </header>

        <!-- MAIN CONTENT -->
        <main class="container">

            <!-- PAGE: HOME -->
            <section id="page-home" class="page active">
                <div class="hero-section">
                    <div class="hero-content">
                        <span class="tag">Powered by OpenFoodFacts</span>
                        <h1>Welcome back, <span id="hero-user-name">User</span></h1>
                        <p>Scan, search, and discover the nutritional value and environmental impact of your food. Make informed choices for your health and the planet.</p>
                        <div class="hero-actions">
                            <input type="search" class="hero-search" id="hero-search-input" placeholder="Search for food products...">
                            <button class="btn btn-primary" id="hero-start-scanning">
                                <span></span> Start Scanning
                            </button>
                            <button class="btn btn-secondary" id="hero-learn-more">Learn More</button>
                        </div>
                    </div>
                    <div class="hero-image-wrapper">
                        <img src="https://picsum.photos/seed/ecofood/800/600"
                             alt="Fresh healthy food"
                             class="hero-image">
                        <div class="hero-badge nutrition-badge">
                            <span class="badge-grade">A</span>
                            <div>
                                <strong>Nutrition Score</strong>
                                <span>Excellent</span>
                            </div>
                        </div>
                        <div class="hero-badge co2-badge">
                            <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg>
                            <div>
                                <strong>CO2 Saved</strong>
                                <span>12.4 kg</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- PAGE: SEARCH -->
            <section id="page-search" class="page">
                <h2>Search & Discover</h2>
                <p>Find nutritional and environmental information for any food product.</p>

                <div class="search-large-wrapper">
                    <input type="search" id="main-search-input" class="search-large" placeholder="Search by product name, brand, or barcode...">
                </div>

                <div id="search-results-container"></div>

                <div class="card-grid three-cols">
                    <div class="card card-action" id="action-scan-barcode" tabindex="0" role="button">
                        <svg class="card-icon" viewBox="0 0 24 24"><path d="M4 6h2v12H4zm3 0h1v12H7zm2 0h2v12H9zm3 0h1v12h-1zm2 0h3v12h-3zm4 0h1v12h-1z"></path></svg>
                        <h3>Scan Barcode</h3>
                        <p>Use your device camera to scan product barcodes.</p>
                    </div>
                    <div class="card card-action" id="action-upload-image" tabindex="0" role="button">
                        <svg class="card-icon" viewBox="0 0 24 24"><path d="M9 16h6v-6h4l-7-7-7 7h4v6zm-4 4h14v2H5z"></path></svg>
                        <h3>Upload Image</h3>
                        <p>Upload a photo of a product barcode to scan.</p>
                        <input type="file" id="image-upload-input" class="hidden" accept="image/*">
                    </div>
                    <div class="card card-action" id="action-enter-barcode" tabindex="0" role="button">
                        <svg class="card-icon" viewBox="0 0 24 24"><path d="M3 5h2v14H3zm4 0h1v14H7zm2 0h2v14H9zm4 0h1v14h-1zm3 0h2v14h-2zm3 0h1v14h-1z"></path></svg>
                        <h3>Enter Barcode</h3>
                        <p>Manually type a product barcode number.</p>
                    </div>
                </div>

                <h3>Popular Searches</h3>
                <div class="chip-container" id="recent-searches">
                    <span class="chip" data-query="Almond Milk">Almond Milk</span>
                    <span class="chip" data-query="Whole Grain Bread">Whole Grain Bread</span>
                    <span class="chip" data-query="Greek Yogurt">Greek Yogurt</span>
                    <span class="chip" data-query="Nutella">Nutella</span>
                    <span class="chip" data-query="Oat Milk">Oat Milk</span>
                </div>
            </section>

            <!-- PAGE: DASHBOARD -->
            <section id="page-dashboard" class="page">
                <h2>Eco-Points Dashboard</h2>
                <p>Track your progress and earn rewards for sustainable choices.</p>

                <div class="dashboard-layout">
                    <div class="dashboard-main">
                        <div class="card eco-points-card">
                            <div class="points-info">
                                <span class="points-label">Total Eco-Points</span>
                                <span class="points-total" id="total-eco-points">0</span>
                            </div>
                            <div class="points-chart-wrapper">
                                <canvas id="ecoPointsChart"></canvas>
                                <div class="points-chart-text">
                                    <span id="eco-points-percentage">0%</span>
                                    <span>to Level 2</span>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <h3>Weekly Scans</h3>
                            <div class="chart-container">
                                <canvas id="weeklyProgressChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <aside class="dashboard-sidebar">
                        <div class="card">
                            <h3>Your Impact</h3>
                            <div class="impact-stat">
                                <label>Total Scans</label>
                                <div class="impact-value" id="stat-total-scans">0</div>
                                <progress id="impact-scans" value="0" max="100"></progress>
                            </div>
                            <div class="impact-stat">
                                <label>Products Found</label>
                                <div class="impact-value" id="stat-products-found">0</div>
                                <progress id="impact-products" value="0" max="100"></progress>
                            </div>
                            <div class="impact-stat">
                                <label>Healthy Choices (Nutri-Score A/B)</label>
                                <div class="impact-value" id="stat-healthy">0</div>
                                <progress id="impact-healthy" value="0" max="100"></progress>
                            </div>
                        </div>
                        <div class="card">
                            <h3>Recent Activity</h3>
                            <div id="recent-activity" class="recent-activity">
                                <p class="empty-state">No scans yet. Start scanning to see your activity!</p>
                            </div>
                        </div>
                    </aside>
                </div>
            </section>

            <!-- PAGE: PROFILE -->
            <section id="page-profile" class="page">
                <h2>Profile & Settings</h2>
                <p>Manage your account and preferences.</p>

                <div class="profile-layout">
                    <div class="profile-main">
                        <!-- Profile Card -->
                        <div class="card profile-card">
                            <div class="profile-header">
                                <div class="profile-avatar-wrapper">
                                    <img id="profile-avatar" class="profile-avatar" src="" alt="Profile picture">
                                    <span id="profile-avatar-initial" class="profile-avatar-initial"></span>
                                    <label for="avatar-upload" class="avatar-upload-btn" title="Change photo">
                                        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></svg>
                                    </label>
                                    <input type="file" id="avatar-upload" class="hidden" accept="image/*">
                                </div>
                                <div class="profile-info">
                                    <h3 id="profile-display-name">User</h3>
                                    <p id="profile-email">user@example.com</p>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="edit-display-name">Display Name</label>
                                <input type="text" id="edit-display-name" placeholder="Your name">
                            </div>
                            <button class="btn btn-primary" id="save-profile-btn">Save Changes</button>
                        </div>

                        <!-- Appearance -->
                        <div class="card">
                            <h3>Appearance</h3>
                            <div class="setting-item">
                                <div>
                                    <strong>Dark Mode</strong>
                                    <p>Switch to dark theme</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="toggle-dark-mode">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <strong>Larger Text</strong>
                                    <p>Increase font size for better readability</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="toggle-large-text">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <!-- Account -->
                        <div class="card">
                            <h3>Account</h3>
                            <p class="privacy-note">
                                Your data is stored securely. Only you can access your profile and scan history.
                            </p>
                            <button class="btn btn-danger full-width" id="logout-btn">Sign Out</button>
                        </div>
                    </div>
                    <aside class="profile-sidebar">
                        <div class="card">
                            <h3>Favorites</h3>
                            <div class="favorites-list" id="favorites-list">
                                <p class="empty-state">You have no favorites yet. Search and scan products to add them!</p>
                            </div>
                        </div>
                    </aside>
                </div>
            </section>

            <!-- PAGE: ABOUT -->
            <section id="page-about" class="page">
                <div class="about-hero">
                    <h2>About EcoFood Tracker</h2>
                    <p>Empowering consumers to make healthier, more sustainable food choices through transparency and data.</p>
                </div>

                <div class="about-mission card">
                    <div class="mission-text">
                        <h3>Our Mission</h3>
                        <p>We believe that everyone deserves access to clear, actionable information about the food they eat. Our mission is to democratize food transparency and help people make choices that are good for their health and the planet.</p>
                    </div>
                    <div class="mission-image">
                        <img src="https://picsum.photos/seed/freshfood/800/600" alt="Fresh fruits and vegetables">
                    </div>
                </div>

                <div class="about-features">
                    <h3 class="text-center">What Makes Us Different</h3>
                    <p class="text-center subtitle">Privacy-first, open-source, and built for you.</p>
                    <div class="card-grid three-cols">
                        <div class="card text-center">
                            <svg class="card-icon" viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"></path></svg>
                            <h4>Privacy First</h4>
                            <p>Your data is secure and only accessible to you.</p>
                        </div>
                        <div class="card text-center">
                            <svg class="card-icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path></svg>
                            <h4>Open Data</h4>
                            <p>Built on OpenFoodFacts, a free and open database maintained by volunteers worldwide.</p>
                        </div>
                        <div class="card text-center">
                            <svg class="card-icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15v-4H7.5l5-9v4H17l-5 9z"></path></svg>
                            <h4>Sustainability Focus</h4>
                            <p>Not just nutrition — we show you the environmental impact of your food choices.</p>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <!-- FOOTER -->
        <footer class="site-footer">
            <div class="container footer-content">
                <div class="footer-col">
                    <a href="#" class="logo footer-logo" data-page="home">
                        <svg class="logo-icon" width="28" height="28" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="50" cy="50" r="48" fill="#2d8a6e"/>
                            <path d="M70 25C45 25 28 42 28 62c0 6 2 10 5 13 3-15 12-28 27-35-10 12-16 26-17 40 2 1 4 2 7 2 18 0 30-15 30-35 0-8-2-15-5-20" fill="white" opacity="0.95"/>
                        </svg>
                        <span>EcoFood Tracker</span>
                    </a>
                </div>
                <div class="footer-col">
                    <strong>Quick Links</strong>
                    <ul>
                        <li><a href="#" class="footer-nav-link" data-page="home">Home</a></li>
                        <li><a href="#" class="footer-nav-link" data-page="search">Search Foods</a></li>
                        <li><a href="#" class="footer-nav-link" data-page="dashboard">Dashboard</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <strong>More</strong>
                    <ul>
                        <li><a href="#" class="footer-nav-link" data-page="profile">Settings</a></li>
                        <li><a href="#" class="footer-nav-link" data-page="about">About Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="container footer-legal">
                <p>&copy; 2025 EcoFood Tracker. Powered by OpenFoodFacts.</p>
            </div>
        </footer>

    </div><!-- /app-wrapper -->

    <!-- ========== MODALS ========== -->

    <!-- Generic Modal -->
    <div id="modal-overlay" class="modal-overlay hidden"></div>
    <div id="modal-container" class="modal-container hidden">
        <button id="modal-close-btn" class="modal-close" aria-label="Close modal">&times;</button>
        <div id="modal-content"></div>
    </div>

    <!-- Camera Scanner Modal -->
    <div id="scanner-overlay" class="modal-overlay hidden"></div>
    <div id="scanner-modal" class="modal-container scanner-modal hidden">
        <button id="scanner-close-btn" class="modal-close">&times;</button>
        <h2>Scan Barcode</h2>
        <p>Align the barcode inside the box.</p>
        <div id="scanner-view" class="scanner-view"></div>
        <p id="scanner-status" class="scanner-status">Initializing camera...</p>
    </div>

    <!-- Manual Barcode Entry Modal -->
    <div id="barcode-overlay" class="modal-overlay hidden"></div>
    <div id="barcode-modal" class="modal-container barcode-modal hidden">
        <button id="barcode-close-btn" class="modal-close">&times;</button>
        <h2>Enter Barcode</h2>
        <p>Type the barcode number found on the product packaging.</p>
        <input id="barcode-input" type="text" class="barcode-input" placeholder="e.g. 3017620422003" autocomplete="off">
        <button id="barcode-search-btn" class="btn btn-primary full-width">Search Product</button>
    </div>

</body>
</html>
